# Copyright (c) 2010, 2012, 2013, 2014
#       Thorsten Glaser <tg@mirbsd.org>
# This file is provided under the same terms as mksh.
#-
# Minimal /system/etc/mkshrc for Android
#
# Support: https://launchpad.net/mksh

if ((USER_ID)); then PS1='$'; else PS1='#'; fi

# Get current user for node_modules folder end yarn configuration.
if ((USER_ID)); then CURRENT_USER='0'; else CURRENT_USER=$(am get-current-user); fi

export HOME="/data/system/users/$CURRENT_USER"
export USER=$(id -un)
export HOSTNAME=$(cat /proc/sys/kernel/hostname)

PS1=$'\e[35m┌\e[0m\e[92m$USER@$HOSTNAME\e[0m:\e[34m${PWD:-?}\e[0m\n\e[35m└─\e[0m# '
PS0="└─"

# Not tested yet
# export PREFIX=/system
export CURRENT_USER="$CURRENT_USER"
export TMPDIR="/data/local/tmp"
export YARN_HOME="/system/usr/share"
export TERM="xterm-256color"

# PATH Binary Folder
export SYSTEM_EXT_BIN="/system/system_ext/bin"
export SYSTEM_BIN="/system/bin"
export SYSTEM_PRODUCT_BIN="/system/product/bin"
export VENDOR_BIN="/vendor/bin"
## Node.js module requirements
export YARN_BIN="$YARN_HOME/.yarn/bin"
export YARN_GLOBAL_BIN="$HOME/.config/yarn/global/node_modules/.bin"
export PATH="$YARN_BIN:$YARN_GLOBAL_BIN:$SYSTEM_BIN:$SYSTEM_EXT_BIN$VENDOR_BIN:$SYSTEM_PRODUCT_BIN:$PATH"

# Aliases
alias bsu='su -s bash'
alias ls='ls --color=auto'
alias lsa='ls --color=auto -A'

# Loads user defined scripts
for script in $HOME/etc/profile.d/*.sh ; do
  if [ -f $script ] ; then
    . $script
  fi
done

# Keep the storage clear and use user based mkshrc
if [ -f "$HOME/etc/mkshrc" ]; then
  . $HOME/etc/mkshrc
fi
